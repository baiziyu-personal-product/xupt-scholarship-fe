var k=Object.defineProperty,I=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var B=(s,t,a)=>t in s?k(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,D=(s,t)=>{for(var a in t||(t={}))v.call(t,a)&&B(s,a,t[a]);if(b)for(var a of b(t))T.call(t,a)&&B(s,a,t[a]);return s},S=(s,t)=>I(s,L(t));import{r as e,C as V,E as j,V as A,F as y,z as w,s as H,G as N,e as C,m as g,W as M,X as q,Y as z,Z as G}from"./vendor-d77eef1c.js";import{p as O,A as P,g as X}from"./index-4622fea5.js";import{a as K}from"./index-89cb7035.js";import"./index-e1bb8195.js";import"./index-7212b9a5.js";import"./page-header-6125e98d.js";const Q=()=>{const[s,t]=e.exports.useState([]);return e.exports.createElement(V,null,s.length?e.exports.createElement(A,{mode:"left"},s.map(a=>e.exports.createElement(A.Item,{key:a.time,label:a.time},a.info))):e.exports.createElement(j,null))},R=new Map([["save","\u5DF2\u4FDD\u5B58"],["submit","\u5DF2\u63D0\u4EA4"],["success","\u5DF2\u9A8C\u8BC1"],["failed","\u672A\u9A8C\u8BC1"]]);var _={"score-form":"xupt_sHsstyle-module__score-form__173mI","score-form-item":"xupt_sHsstyle-module__score-form-item__1bQEq","form-top-label":"xupt_sHsstyle-module__form-top-label__3GLX-","compute-icon":"xupt_sHsstyle-module__compute-icon__3qOKv"};const W=[{type:"moral",name:"\u601D\u60F3\u54C1\u5FB7\u5206\u6570"},{type:"practice",name:"\u5B9E\u8DF5\u6D3B\u52A8\u5206\u6570"},{type:"academic",name:"\u5B66\u672F\u5206\u6570"},{type:"sum",name:"\u603B\u548C"}],h=s=>{const{initValue:t,applyId:a,submitCallBack:m}=s,[d,x]=e.exports.useState(t==null?void 0:t.sum),[n,p]=e.exports.useState(!1),f=(o,i)=>{const c=Object.values(i).reduce((r,F)=>(r+=+F,r),0);x(c)},[l]=y.useForm(),E=async()=>{const o=l.getFieldsValue(!0);try{p(!0),await O(a,S(D({},o),{sum:d})),m&&await m(),g.success("\u8BC4\u5B9A\u6210\u529F")}catch(i){g.error(i.message)}finally{p(!1)}};return e.exports.useEffect(()=>{t&&l.setFieldsValue(t)},[t,a]),e.exports.createElement(y,{className:_["score-form"],layout:"inline",form:l,onValuesChange:f,initialValues:t},e.exports.createElement(w,{align:"center"},W.map(o=>e.exports.createElement(e.exports.Fragment,{key:o.type},e.exports.createElement("div",{className:_["score-form-item"]},o.type==="sum"?e.exports.createElement(H,{valueStyle:{fontSize:20},key:"score",title:"\u603B\u5206",value:d}):e.exports.createElement(e.exports.Fragment,null,e.exports.createElement("div",{className:_["form-top-label"]},o.name),e.exports.createElement(y.Item,{name:o.type},e.exports.createElement(N,{min:0,disabled:n})))),o.type!=="sum"&&e.exports.createElement("span",{className:_["compute-icon"]},o.type==="academic"?" = ":" + ")))),e.exports.createElement(y.Item,null,e.exports.createElement(C,{onClick:E,loading:n,type:"primary"},"\u786E\u8BA4\u5206\u6570\u5E76\u63D0\u4EA4")))};h.defaultProps={initValue:{moral:0,practice:0,academic:0,sum:0}};const Y=s=>[{title:"\u8868\u5355ID",dataIndex:"id",key:"id"},{title:"\u5F53\u524D\u72B6\u6001",dataIndex:"handle_state",key:"handle_state",render:t=>e.exports.createElement(M,{color:t==="submit"?"success":"geekblue"},R.get(t))},{title:"\u5B66\u53F7",dataIndex:"user_id",key:"user_id"},{title:"\u5F97\u5206",dataIndex:"score",key:"score"},{title:"\u6700\u8FD1\u8BC4\u5BA1\u4EBA\u5DE5\u53F7",dataIndex:"comment_user",key:"comment_user"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"create_at",dataIndex:"create_at"},{title:"\u66F4\u65B0\u65F6\u95F4",key:"edit_at",dataIndex:"edit_at"},{title:"\u64CD\u4F5C",key:"action",render:(t,a)=>e.exports.createElement(C,{type:"dashed",shape:"round",onClick:()=>s(a.id),icon:e.exports.createElement(q,null)},"\u5BA1\u6838")}],Z=()=>{const[s,t]=e.exports.useState([]),[a,m]=e.exports.useState(!1),[d,x]=e.exports.useState(!1),[n,p]=e.exports.useState(-1),{process_id:f}=K(),l=r=>{x(!0),p(r)},E=()=>{x(!1),p(-1)},o=e.exports.useMemo(()=>Y(l),[l]),i=async()=>{try{m(!0);const F=(await X({page_count:10,page_index:1,is_check:"manager",procedure_id:f})||[]).map(u=>({key:u.id,id:u.id,create_at:u.create_at,edit_at:u.edit_at,handle_state:u.status,score_info:u.score_info,score:u.score,user_id:u.user_id,comment_user:u.step.user_id}));t(F)}catch(r){console.log(r),g.error("\u83B7\u53D6\u7533\u8BF7\u5217\u8868\u5931\u8D25")}finally{m(!1)}},c=e.exports.useMemo(()=>s.find(r=>r.id===n),[s,n]);return e.exports.useEffect(()=>{i()},[]),console.log(c,s,n),e.exports.createElement(e.exports.Fragment,null,e.exports.createElement(z,{onClose:E,visible:d,width:992,headerStyle:{height:48,padding:20},bodyStyle:{padding:"16px 8px"},footer:e.exports.createElement(h,{applyId:n,initValue:c==null?void 0:c.score_info}),footerStyle:{height:80}},e.exports.createElement(P,{commentApplyId:n})),e.exports.createElement(G,{loading:a,columns:o,dataSource:s}))},oe=()=>e.exports.createElement(e.exports.Fragment,null,e.exports.createElement(Q,null),e.exports.createElement(Z,null));export{oe as default};
//# sourceMappingURL=index-c0f96840.js.map
