{"version":3,"file":"index-e1bb8195.js","sources":["../../../src/components/upload-file/index.tsx","../../../src/config/time.ts","../../../src/components/fmt-date-picker/index.tsx"],"sourcesContent":["// 需要后端配置跨域以及进行Options的预连接请求处理\r\nimport * as api from '@/service/upload'\r\nimport { Form, FormItemProps, message, Upload } from 'antd';\r\nimport * as React from 'react';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport { UploadFile, UploadProps } from 'antd/lib/upload/interface';\r\n\r\ninterface IProps extends React.PropsWithChildren<{}> {\r\n  formProps?: FormItemProps;\r\n}\r\n\r\ninterface IProps extends UploadProps<any> { }\r\n\r\nconst normFile: FormItemProps['getValueFromEvent'] = (e) => {\r\n  if (Array.isArray(e)) {\r\n    return e;\r\n  }\r\n  return e && e.fileList;\r\n};\r\n\r\nconst UploadDragger: React.FC<IProps> = (props) => {\r\n  const { children, formProps, ...resetProps } = props;\r\n  const [fileList, setFileList] = React.useState<UploadFile[]>([]);\r\n  const uploadFileList = async (list: UploadFile[]) => {\r\n    try {\r\n      const uploadList = await api.postUploadApplyFileList(list);\r\n      const finishList = fileList.map((item, index) => ({\r\n        ...item,\r\n        status: 'success',\r\n        url: uploadList[index],\r\n        percent: 1,\r\n      }));\r\n      setFileList(finishList as any[]);\r\n    } catch (error) {\r\n      message.error(\"上传失败\");\r\n    } finally {\r\n\r\n    }\r\n  }\r\n  React.useEffect(() => {\r\n    if (\r\n      fileList.some(item => item.status !== 'success')\r\n    ) {\r\n      const needLoadList = fileList.filter(item => item.status !== 'success' || item.url === \"\");\r\n      uploadFileList(needLoadList);\r\n    }\r\n  }, [fileList]);\r\n  return (\r\n    <Form.Item\r\n      valuePropName=\"fileList\"\r\n      getValueFromEvent={normFile}\r\n      {...formProps}\r\n    >\r\n      <Upload.Dragger\r\n        {...resetProps}\r\n        beforeUpload={(_, uploadFileList) => {\r\n          setFileList(uploadFileList);\r\n          return false;\r\n        }}\r\n        multiple\r\n        fileList={fileList}\r\n      >\r\n        <p className=\"ant-upload-drag-icon\">\r\n          <InboxOutlined />\r\n        </p>\r\n        {children}\r\n      </Upload.Dragger>\r\n    </Form.Item>\r\n  );\r\n};\r\n\r\nUploadDragger.defaultProps = {\r\n  formProps: {\r\n    noStyle: true\r\n  }\r\n}\r\n\r\nexport default UploadDragger;","import moment from \"moment\";\n\nexport const TIME_FORMAT_NORMAL = \"YYYY-MM-DD HH:mm:ss\";\nexport const DATE_FORMAT_NORMAL = \"YYYY-MM-DD\"\nexport const FORMAT_DATE = moment();","import * as React from 'react';\nimport { DatePicker } from 'antd';\nimport { DATE_FORMAT_NORMAL, FORMAT_DATE } from '@/config/time';\nimport moment from 'moment';\n\ninterface IProps extends Record<string, any> {\n  type?: 'range' | 'normal';\n  className?: string;\n}\n\nconst FmtDatePicker: React.FC<IProps> = (props) => {\n  const { type, className, ...resetProps } = props;\n  const value = type === 'normal'\n    ? (resetProps.value ? moment(resetProps.value, DATE_FORMAT_NORMAL) : undefined)\n    : (\n      Array.isArray(resetProps.value)\n        ? (\n          resetProps.value.length > 0\n            ? [\n              moment(resetProps.value[0], DATE_FORMAT_NORMAL),\n              moment(resetProps.value[1], DATE_FORMAT_NORMAL)\n            ]\n            : undefined\n        )\n        : undefined\n    );\n  return (\n    <React.Fragment>\n      {\n        type === 'normal' ? (\n          <DatePicker\n            className={className}\n            {...resetProps}\n            value={value as any}\n          />\n        ) : (\n            <DatePicker.RangePicker\n              {...resetProps as any}\n              className={className}\n              value={value as any}\n            />\n          )\n      }\n    </React.Fragment>\n  );\n};\n\nFmtDatePicker.defaultProps = {\n  type: 'normal',\n  className: ''\n}\n\nexport default FmtDatePicker;"],"names":["React.useState","api.postUploadApplyFileList","React.Fragment"],"mappings":"0sBAaA,KAAM,GAA+C,AAAC,GAChD,MAAM,QAAQ,GACT,EAEF,GAAK,EAAE,SAGV,EAAkC,AAAC,GAAU,MACF,KAAvC,YAAU,aAA6B,EAAf,IAAe,EAAf,CAAxB,WAAU,cACZ,CAAC,EAAU,GAAeA,mBAA6B,IACvD,EAAiB,KAAO,IAAuB,IAC/C,MACI,GAAa,KAAMC,GAA4B,GAC/C,EAAa,EAAS,IAAI,CAAC,EAAM,WAClC,IACH,OAAQ,UACR,IAAK,EAAW,GAChB,QAAS,OAEC,WAEJ,MAAM,kEAKF,IAAM,IAElB,EAAS,KAAK,GAAQ,EAAK,SAAW,WACtC,MACM,GAAe,EAAS,OAAO,GAAQ,EAAK,SAAW,WAAa,EAAK,MAAQ,MACxE,KAEhB,CAAC,4BAED,EAAK,KAAN,GACE,cAAc,WACd,kBAAmB,GACf,2BAEH,EAAO,QAAR,OACM,GADN,CAEE,aAAc,CAAC,EAAG,OACJ,GACL,IAET,SAAQ,GACR,qCAEC,IAAD,CAAG,UAAU,gDACV,EAAD,OAED,KAMT,EAAc,aAAe,CAC3B,UAAW,CACT,QAAS,UCtEA,GAAqB,aACrB,EAAc,ICMrB,EAAkC,AAAC,GAAU,MACN,KAAnC,QAAM,aAA6B,EAAf,IAAe,EAAf,CAApB,OAAM,cACR,EAAQ,IAAS,SAClB,EAAW,MAAQ,EAAO,EAAW,MAAO,GAAsB,OAEnE,MAAM,QAAQ,EAAW,QAErB,EAAW,MAAM,OAAS,EACtB,CACA,EAAO,EAAW,MAAM,GAAI,GAC5B,EAAO,EAAW,MAAM,GAAI,IAIhC,sCAGLC,mBAAD,KAEI,IAAS,iCACN,EAAD,KACE,aACI,GAFN,CAGE,mCAGC,EAAW,YAAZ,OACM,GADN,CAEE,YACA,aAQd,EAAc,aAAe,CAC3B,KAAM,SACN,UAAW"}