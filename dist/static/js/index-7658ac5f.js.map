{"version":3,"file":"index-7658ac5f.js","sources":["../../../src/components/upload-file/index.tsx","../../../src/components/fmt-date-picker/index.tsx"],"sourcesContent":["// 需要后端配置跨域以及进行Options的预连接请求处理\r\nimport * as api from '@/service/upload'\r\nimport { Form, FormItemProps, message, Upload } from 'antd';\r\nimport * as React from 'react';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport { UploadFile, UploadProps } from 'antd/lib/upload/interface';\r\n\r\ninterface IProps extends React.PropsWithChildren<{}> {\r\n  formProps?: FormItemProps;\r\n}\r\n\r\ninterface IProps extends UploadProps<any> { }\r\n\r\nconst normFile: FormItemProps['getValueFromEvent'] = (e) => {\r\n  if (Array.isArray(e)) {\r\n    return e;\r\n  }\r\n  return e && e.fileList;\r\n};\r\n\r\nconst UploadDragger: React.FC<IProps> = (props) => {\r\n  const { children, formProps, ...resetProps } = props;\r\n  const [fileList, setFileList] = React.useState<UploadFile[]>([]);\r\n  const uploadFileList = async (list: UploadFile[]) => {\r\n    try {\r\n      const uploadList = await api.postUploadApplyFileList(list);\r\n      const finishList = fileList.map((item, index) => ({\r\n        ...item,\r\n        status: 'success',\r\n        url: uploadList[index],\r\n        percent: 1,\r\n      }));\r\n      setFileList(finishList as any[]);\r\n    } catch (error) {\r\n      message.error(\"上传失败\");\r\n    } finally {\r\n\r\n    }\r\n  }\r\n  React.useEffect(() => {\r\n    if (\r\n      fileList.some(item => item.status !== 'success')\r\n    ) {\r\n      const needLoadList = fileList.filter(item => item.status !== 'success' || item.url === \"\");\r\n      uploadFileList(needLoadList);\r\n    }\r\n  }, [fileList]);\r\n  return (\r\n    <Form.Item\r\n      valuePropName=\"fileList\"\r\n      getValueFromEvent={normFile}\r\n      {...formProps}\r\n    >\r\n      <Upload.Dragger\r\n        {...resetProps}\r\n        beforeUpload={(_, uploadFileList) => {\r\n          setFileList(uploadFileList);\r\n          return false;\r\n        }}\r\n        multiple\r\n        fileList={fileList}\r\n      >\r\n        <p className=\"ant-upload-drag-icon\">\r\n          <InboxOutlined />\r\n        </p>\r\n        {children}\r\n      </Upload.Dragger>\r\n    </Form.Item>\r\n  );\r\n};\r\n\r\nUploadDragger.defaultProps = {\r\n  formProps: {\r\n    noStyle: true\r\n  }\r\n}\r\n\r\nexport default UploadDragger;","import * as React from 'react';\r\nimport { DatePicker } from 'antd';\r\nimport { DATE_FORMAT_NORMAL, FORMAT_DATE } from '@/config/time';\r\nimport moment from 'moment';\r\n\r\ninterface IProps extends Record<string, any> {\r\n  type?: 'range' | 'normal';\r\n  className?: string;\r\n}\r\n\r\nconst FmtDatePicker: React.FC<IProps> = (props) => {\r\n  const { type, className, ...resetProps } = props;\r\n  const value = type === 'normal'\r\n    ? (resetProps.value ? moment(resetProps.value, DATE_FORMAT_NORMAL) : undefined)\r\n    : (\r\n      Array.isArray(resetProps.value)\r\n        ? (\r\n          resetProps.value.length > 0\r\n            ? [\r\n              moment(resetProps.value[0], DATE_FORMAT_NORMAL),\r\n              moment(resetProps.value[1], DATE_FORMAT_NORMAL)\r\n            ]\r\n            : undefined\r\n        )\r\n        : undefined\r\n    );\r\n  return (\r\n    <React.Fragment>\r\n      {\r\n        type === 'normal' ? (\r\n          <DatePicker\r\n            className={className}\r\n            {...resetProps}\r\n            value={value as any}\r\n          />\r\n        ) : (\r\n            <DatePicker.RangePicker\r\n              {...resetProps as any}\r\n              className={className}\r\n              value={value as any}\r\n            />\r\n          )\r\n      }\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nFmtDatePicker.defaultProps = {\r\n  type: 'normal',\r\n  className: ''\r\n}\r\n\r\nexport default FmtDatePicker;"],"names":["React.useState","api.postUploadApplyFileList","React.Fragment"],"mappings":"4uBAaA,KAAM,GAA+C,AAAC,GAChD,MAAM,QAAQ,GACT,EAEF,GAAK,EAAE,SAGV,EAAkC,AAAC,GAAU,MACF,KAAvC,YAAU,aAA6B,EAAf,IAAe,EAAf,CAAxB,WAAU,cACZ,CAAC,EAAU,GAAeA,mBAA6B,IACvD,EAAiB,KAAO,IAAuB,IAC/C,MACI,GAAa,KAAMC,GAA4B,GAC/C,EAAa,EAAS,IAAI,CAAC,EAAM,WAClC,IACH,OAAQ,UACR,IAAK,EAAW,GAChB,QAAS,OAEC,WAEJ,MAAM,kEAKF,IAAM,IAElB,EAAS,KAAK,GAAQ,EAAK,SAAW,WACtC,MACM,GAAe,EAAS,OAAO,GAAQ,EAAK,SAAW,WAAa,EAAK,MAAQ,MACxE,KAEhB,CAAC,4BAED,EAAK,KAAN,GACE,cAAc,WACd,kBAAmB,GACf,2BAEH,EAAO,QAAR,OACM,GADN,CAEE,aAAc,CAAC,EAAG,OACJ,GACL,IAET,SAAQ,GACR,qCAEC,IAAD,CAAG,UAAU,gDACV,EAAD,OAED,KAMT,EAAc,aAAe,CAC3B,UAAW,CACT,QAAS,UC/DP,GAAkC,AAAC,GAAU,MACN,KAAnC,QAAM,aAA6B,EAAf,IAAe,EAAf,CAApB,OAAM,cACR,EAAQ,IAAS,SAClB,EAAW,MAAQ,EAAO,EAAW,MAAO,GAAsB,OAEnE,MAAM,QAAQ,EAAW,QAErB,EAAW,MAAM,OAAS,EACtB,CACA,EAAO,EAAW,MAAM,GAAI,GAC5B,EAAO,EAAW,MAAM,GAAI,IAIhC,sCAGLC,mBAAD,KAEI,IAAS,iCACN,EAAD,KACE,aACI,GAFN,CAGE,mCAGC,EAAW,YAAZ,OACM,GADN,CAEE,YACA,aAQd,EAAc,aAAe,CAC3B,KAAM,SACN,UAAW"}